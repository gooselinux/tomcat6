--- java/org/apache/coyote/http11/InternalNioInputBuffer.java.orig	2011-02-08 16:27:50.270298000 -0500
+++ java/org/apache/coyote/http11/InternalNioInputBuffer.java	2011-02-08 16:31:57.596778000 -0500
@@ -578,6 +578,10 @@
     
     private void expand(int newsize) {
         if ( newsize > buf.length ) {
+           if (parsingHeader) {
+              throw new IllegalArgumentException(
+                              sm.getString("iib.requestheadertoolarge.error"));
+            }
             byte[] tmp = new byte[newsize];
             System.arraycopy(buf,0,tmp,0,buf.length);
             buf = tmp;
